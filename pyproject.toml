[tool.poetry]
authors = ["Eliot Courtney <edgeworth.dev@gmail.com>"]
classifiers = ["License :: OSI Approved :: GPL-3.0-only"]
description = "memerna"
name = "memerna"
readme = "README.md"
version = "0.1.0"

[tool.poetry.dependencies]
bidict = "^0.22.0"
click = "^8.1.3"
click_log = "^0.4.0"
cloup = "^1.0.0"
protobuf = "3.20.1" # Breaking release, so keep this as 3.20.1 for now.
python = "~3.10"
ray = "^1.13.0"

python-dotenv = "^0.20.0"
torch = {
  url = "https://download.pytorch.org/whl/cu116/torch-1.12.0%2Bcu116-cp310-cp310-linux_x86_64.whl"
} # Poetry can't handle extra-index-url, or anything else that would help.
torch-tb-profiler = "^0.4.0"

[tool.poetry.dev-dependencies]
black = "^22.6.0"
mypy = "^0.971"
prospector = "^1.7.7"

[tool.mypy]
show_column_numbers = true
# Require type hints
disallow_untyped_defs = true

# Allow types that is not imported to be used in annotations.
# This is necessary because some libraries don't have annotations.
disallow_any_unimported = false

# Disallow implicit optional e.g. arg: str = None
no_implicit_optional = true

# Check bodies of functions without type annotations too
check_untyped_defs = true

# Warn about returning Any from a function annotated to not return it
warn_return_any = true

# Warn about unused ignore annotations
warn_unused_ignores = true

# Show error codes
show_error_codes = true

# Set python version.
python_version = '3.10'

# No type hints for torchvision.
[[tool.mypy.overrides]]
ignore_missing_imports = true
module = ["torchvision.*", "torchtext.*", "click_log.*", "numpy.*", "ViennaRNA.*"]

[tool.black]
line-length = 100
target-version = ['py310']

[tool.pylint.format]
max-line-length = 100

[tool.pylint.typecheck]
generated-members = "numpy.*,torch.*"

[tool.pylint.messages_control]
# Fix "not callable" errors for torch.nn.Module subclasses
# Want to use f-strings in logging
# unsubscriptable-object: Fix false positive on bimap indexing
# too-many-arguments: Unavoidable sometimes.
# consider-using-enumerate: False positives for: for i in range(len(...))
disable = [
  "not-callable",
  "logging-fstring-interpolation",
  "unsubscriptable-object",
  "too-many-arguments",
  "consider-using-enumerate",
]
